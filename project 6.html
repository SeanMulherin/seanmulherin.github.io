<!DOCTYPE HTML>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
<html>
	<head>
		<title>Artificial Neural Network</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<div class="inner">
							<!-- Nav -->
								<nav>
									<ul>
										<li><a href="#menu">Menu</a></li>
									</ul>
								</nav>

						</div>
					</header>

				<!-- Menu -->
					<nav id="menu">
						<h2>Menu</h2>
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="resume.html">Resume</a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">
						<div class="inner">
							<center><h1>An Artificial Neural Network Approach to Identifying Diabetes Risk Status</h1></center>
							<span class="image main"><img src="Diabetes NN/plotnet.png" alt="" /></span>
							<h4>December 8, 2023</h4>
							<p>
								Hey team,<br>
								Today's article is one meant to educate about neural networks and their inner workings.
								I'll walk through the process of coding a neural network, explaining the relevant math and concepts behind it, including powerful ideas such as 
								gradient descent and forward/backward propagation.
								Neural networks are a complex topic so to help explain and understand the ideas, we will work through a classification problem.
								Our task will be to classify peoples' risk of developing type 2 diabetes. 

								<h2><hr><center>A Metaphor on Sorting Big Data</center><hr></h2>
								To get a better idea of the complexity this requires, let's imagine skittles and a strainer. You have a MASSIVE bag containing hundreds of thousands of skittles and only one strainer
								with only three holes in it - the idea being we need to sort these skittles into three different groups. You begin to pour your bag of skittles into the strainer to 
								separate them. Almost immediately, you notice issues with this process because the strainer is too constrictive and can't handle so many skittles. Some skittles get sorted through, but only
								few at a time. While you are waiting for your skittles to slowly move through, you see another strainer. This one has ten holes in it and a brilliant idea pops into your head 
								- you place the strainer with ten holes atop the strainer with three holes and continue to pour the skittles into this stack of now two strainers. Note, we can say this <u><i>system</i></u>
								of strainers has two <u><i>layers</i></u>. Your idea works! You notice the skittles are sorting through the <u><i>system</i></u> at a faster rate than when you had just the 
								one strainer. So, to further expedite this process and increase the <u><i>power</i></u> of your system, you go out to buy more strainers with more holes and add them 
								as additional <u><i>layers</i></u> to your <u><i>system</i></u>. This is one method to handle extremely large data sets, or <u><i>big data.</i></u>

								<center><img src="Diabetes NN/strainer.jpg" heigh=300 width=300 alt="" /></center>
								<blockquote><strong>Figure 1.</strong> A diagram to help visualize a popular sorting method often implemented to handle big data.</blockquote>
								
								<h2><hr><center>The Data</center><hr></h2>
								Today's task is to identify a person's risk of developing type 2 diabetes, given some information about their biology and lifestyle. 
								As of 2019, 37.3 million Americans had been diagnosed with diabetes and 96 million had <u><i>prediabetes</i></u> - defined as having high risk of developing type 2 diabetes <sup>1</sup>. 
								Type 2 diabetes is a chronic disease that describes the body's difficulty in either producing or properly utilizing insulin. Insulin is produced and secreted by the pancreas to help break down
								glucose (i.e. sugar) in the foods you eat. For this reason, people who have diabetes are much more likely to have abnormal levels of glucose in their bloodstream - this metric is commonly
								referred to as <u><i>blood sugar levels</i></u>. If neglected, extremely high or extremely low blood sugar levels can lead to a multitude of health complications such as heart disease, kidney disease, 
								hearing loss, and cataracts, to name a few <sup>2</sup>. Type 2 diabetes is preventable and treatable. With proper nutrition, exercise, and lifestyle habits, people with type 2 diabetes
								can function at high levels with minimal effects on their daily lives. Before we can implement corrective regimens, however, we must first be able to identify one's diabetes risk status.
								The neural network we will build today, trained using robust and reliable data, will help us do just that. 

								<br><br>
								The data set we will be using has been generously provided by the <a href="https://www.cdc.gov/brfss/annual_data/annual_2015.html" target="_blank"> Center for Disease Control and Prevention (CDC)</a>
								as a part of their annual behavioral survey of Americans. 
								In this survey, people are asked questions about their biological health factors and lifestyle habits.  
								Specifically, we have 253, 680 people and 21 variables for each person. This makes for over 5 million values for our network to track. 
								Furthermore, to add to the complexity, many of these variables have two or more levels - meaning they have two or more possible values they can equal. For example, <i>General Health</i> ranges 
								from 1-5, whereas <i>Mental Health</i> ranges from 1-30. All the variables are either numeric, ordinal, or binary, and they all eventually need
								to morph into a single output value: diabetes risk status. We will define diabetes risk status to hold one of two different values: low risk and high risk. <br>

								The variables in our data are as follows: <br><br>
									<div class="table-wrapper">
										<table class="alt">
											<thead>
												<tr>
													<th>Variable</th>
													<th>Description</th>
												</tr>
											</thead>
											<tbody>
												<tr>
													<td>Income</td>
													<td>Level of Income | Numeric (1-8)</td>
												</tr>
												<tr>
													<td>Education</td>
													<td>Level of Education | Numeric (1-6)</td>
												</tr>
												<tr>
													<td>Age	</td>
													<td>Age Category | Numeric (1-13)	</td>
												</tr>
												<tr>
													<td>Sex	</td>
													<td>Binary (Male/Female)	</td>
												</tr>
												<tr>
													<td>Diff Walk	</td>
													<td>Difficulty walking or climbing stairs | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>Physical health	</td>
													<td>The number of days in the past month they've experienced physical illness and injury | Numeric (0-30)</td>
												</tr>
												<tr>
													<td>Any Healthcare</td>
													<td>Have any kind of health care coverage, including health insurance, prepaid plans such as HMO, etc. | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>No Doctor Becuase Cost</td>
													<td>There a time in the past 12 months when they needed to see a doctor but could not because of cost | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>General Health</td>
													<td>Their personal ranking of their general health | Ordinal (1-5)	</td>
												</tr>
												<tr>
													<td>Mental Health</td>
													<td>The number of days in the past month they've experienced feelings of stress, depression, and problems with emotions | Numeric (0-30)</td>
												</tr>
												<tr>
													<td>Hypertension</td>
													<td>High Blood Pressure | Binary (Yes/No)</td>										
												</tr>
												<tr>
													<td>High Cholesterol</td>
													<td>Binary (Yes/No)</td>												
												</tr>
												<tr>
													<td>Cholesterol Check</td>
													<td>Has had a cholesterol check in the last 5 years | Binary (Yes/No)</td>													
												</tr>
												<tr>
													<td>BMI</td>
													<td>Body Mass Index | Numeric (12-98)</td>												
												</tr>
												<tr>
													<td>Smoker</td>
													<td>Has smoked at least 100 cigarettes in their entire life? | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>Stroke</td>
													<td>Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>Heart Disease/Attack	</td>
													<td>Has had coronary heart disease (CHD) or myocardial infarction (MI) | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>Physical Activity</td>
													<td>Has been physically active in the past 30 days | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>Fruits</td>
													<td>Consumes fruit at least once a day | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>Veggies</td>
													<td>Consumes vegetables at least once a day | Binary (Yes/No)</td>
												</tr>
												<tr>
													<td>Heavy Alcohol Consumption</td>
													<td>Adult men having more than 14 drinks per week and adult women having more than 7 drinks per week | Binary (Yes/No)</td>
												</tr>
											</tbody>
										</table>
										This level of complexity and the classification nature of this research question make neural networks a suitable method. 
									</div>
								
			
								<h2><hr><center>Artificial Neural Networks</center><hr></h2>
								An artificial neural network is a classification algorithm setup in such a way as to artificially mimic the human brain. A brain's neural network is a web of interconnected neurons (aka nodes)
								that are activated only when deemed relevant to particular information. 
								Nodes are connected by message pathways; these pathways will strengthen or weaken depending on their relevance. 
								As a simple example, let's say node 1 is good at identifying animals and 
								node 2 is good at identifying ice cream flavors. If you were to sit down and watch The Lion King, node 1 will be much more active than node 2. You 
								can get a sense of how complex this web becomes when you consider all the animals that exist and the often subtle differences between them. It is so complex, in fact, there approximately 100
								billion neurons in the human brain<sup>3</sup>. <br><br>

								In our diabetes example, to sort 253, 680 observations we will code a <i>system</i> with three <i>layers</i>. The first layer is called the <u><i>input layer</i></u> and will take in 
								all 21 variables for each individual person. The second layer is considered to be a <u><i>hidden layer</i></u>. The final layer is the <u><i>output layer</i></u> 
								and will sort the last hidden layer into 2 groups (diabetes risk status). Any layer that is between the input and output layers are considered hidden layers. If a neural network has many
								hidden layers, it is considered to be a <u><i>deep neural network</i></u>.<br><br>
								
								<center><img src="Diabetes NN/nn1.jpg" heigh=600 width=900 alt="" /></center>
								<blockquote>
									<strong>Figure 2.</strong> A diagram portraying the general structure of an artificial neural network. The orange circles are nodes which are analogous to
									neurons in the brain. The red-orange lines represent the information pathways between nodes. The thickness of each line symbolizes the relevance of the connection - 
									as thickness increases, relevance increases. 
								</blockquote>
								
								Consider the neural network diagram above. The task of this neural network is to identify what is shown in the picture. The picture acts as the data we input into our model. 
								Nodes are named \(n_1, n_2,..., n_{13}\). Let's say we have perfect knowledge of how this network functions, and so we know \(n_6\) is exceptional at identifying living organisms, 
								\(n_8\) specializes in identifying animals, \(n_{12}\): mammals, and \(n_{13}\): lions. You can pretend the other nodes are relevant to whatever you'd like. For example, maybe \(n_1\) is good at identifying
								ice cream, and \(n_2\) is exceptional at identifying music, and so on. <br><br>
								
								The process of feeding information through the network is referred to as <u><i>propagation</i></u>.
								This system of intercommunicating nodes that activate/deactivate depending on their relevance leverages the power
								of harmonizing specialization and collaboration. This enables computers to work efficiently and with precision. 

								<h2><hr><center>Mathematical Underpinnings</center><hr></h2>
								In this section, I will delve into the mathematics behind artificial neural networks. I will try my best to foster a tangible and friendly logical flow. However, it is a 
								rather advanced topic so I'm going to articulate under the assumption that you have prerequisite knowledge in the fundamentals of calculus and linear algebra. If you don't have this knowledge, that's okay! There are many online resources 
								if you are interested in learning. I've posted a guide to the topics you need to know, along with didactic video links in the appendix<sup>4</sup>. 
								Okay, let's jump in!<br><br> 

								<center><img src="Diabetes NN/nn2.jpg" heigh=500 width=500 alt="" /></center>
								<blockquote>
										<strong>Figure 3. </strong>A diagram portraying the concepts of weight values used in neural networks. Subscripts specify node numbers. 
										Superscripts specify layer numbers.  
								</blockquote>
								The first thing to understand is that each node communicates information via 'pathways' using weight values, \(W^{(i)}\), where \(i\) represents the layer. These weights range from (0, 1), exclusive. The greater the weight, the more important/relevant 
								the pathway. Each pathway is expressed as a vector of weights. The length of these weight vectors depend on the number of nodes from one layer to the next. Consider the diagram above. Notice layer 1 has
								three nodes and layer 2 has two nodes. This means that there are 6 unique weight vectors containing 'information' in the form of real-numbered values ranging from (0, 1). The key is to optimize these values. 
								In optimizing weight values, we optimize the transfer of information.
								We'll use partial derivatives to help us accomplish this in an algorithm called <u><i>gradient descent</i></u>, but more on that later. Since weights transfer information through the network, it makes sense
								the first weight matrix \(W^{(1)}\) directly involves the data we input \(X\). Thus, the output of our model \(z^{(i)}\) after transferring information from layer 1 to layer 2 is expressed as follows: 
								$$z^{(2)} = XW^{(1)}$$

								The next thing to understand is that each node has an activation function \(f(x)\). This function controls each node's magnitude of importance (i.e. weights). There are a few different activation functions
								that are used in neural networks, the two most common are the <i>Sigmoid function</i> and the <i>ReLu function</i>. Today, we will use the Sigmoid function because 
								it is taught in a typical algebra course and thus more well known. Recall the <a href="https://www.desmos.com/calculator/9dhmdjvx7n" target="_blank"> Sigmoid function</a> is an s-shaped curve 
								that squishes real-numbered outputs such that the range is (0, 1), exclusive. This helps standardize the weight values. Each output matrix  \(z^{(i)}\)  is inputted into this activation function to recalculate
								and readjust weights at each layer of the network. We name this new output \(a^{(i)}\) to specify that it is the newly activated weights. Here it is mathematically: 
								$$f(x) = \frac{1}{1 + e^{-x}}$$
								$$a^{(2)} = f(z^{(2)})$$

								Now that we understand the idea of weights, and how an activation function controls weights, we'll talk about bias terms, \(B^{(i)}\). 
								Each and every node, except in the input layer, has a bias term. You can also think about it as each node that receives information has a bias term.
								These terms, similar to weights, are real-numbered values ranging (0, 1), exclusive. The difference being, instead of transferring information via pathways, 
								bias terms transfer misinformation, or <u><i>error</i></u>. Including an error term as a part of every 'message' from one node to the next is our way to
								acknowledge the unavoidable uncertainty in the information propagated through our network. In essence, we are teaching the model humility. Mathematically,
								to include bias in our model, we simply add this bias matrix to the output matrix  \(z^{(i)}\), as follows:
								$$z^{(2)} = XW^{(1)}+JB^{(1)^{T}}$$
								<blockquote>
									There's some linear algebraic manipulation to make matrix dimensions compatible. Specifically, we take the dot product of the transpose of the bias matrix
									\(B^{(i)^{T}}\) with matrix of ones \(J=[1, 1,..., 1]\).
								</blockquote>

								We continue this process until we reach the output layer. Once we reach the final output layer, the activation matrix is called the predicted output \(\hat{y}\). If we have only 
								one hidden layer, then the entire <u><i>forward propagation</i></u> is expressed mathematically as follows:
								$$z^{(2)} = XW^{(1)}$$
								$$a^{(2)} = f(z^{(2)})$$
								$$z^{(3)} = a^{(2)}W^{(2)}+JB^{(2)^{T}}$$
								$$a^{(3)} = f(z^{(3)})$$
								$$\hat{y} = a^{(3)}$$

								Okay, now it's time to focus on <u><i>backward propagation</i></u> - the process of feeding information backwards through our model. This is where the gradient descent algorithm
								comes into play. First let's talk about the loss function \(L\):
								$$(1)\;\;\; L = \sum (y - \hat{y})^2$$
								$$(2)\;\;\; L = (y - \hat{y})(y - \hat{y})^{T} $$
								<center>\((3)\;\;\; L = (y - Xw)(y - Xw)^{T} \) , where \(w = [W^{(1)}, W^{(2)},...,W^{(i)}] \)</center>
								<blockquote>(1), (2), and (3) are mathematically equivalent. (1) uses sigma notation whereas (2) and (3) use matrix notation.
									(3) substitutes \(\hat{y}\) for \(Xw\). Since data frames are inherently matrices, we will use (3) in our coding algorithm.
								</blockquote>

								This function will look familiar if you've taken an introductory statistics course. It is simply the sum of squared error between the actual output \(y\) and the predicted output \(\hat{y}\).
								We will implement this loss function to calculate the model's accuracy after forward propagation and before backward propagation. When the loss function is minimized, the propagation process
								stops and the model is optimized. The way we minimize the loss function is by implementing the gradient descent algorithm:
								<br><br>
								<blockquote>
									<strong>Gradient Descent Algorithm Methaphor.</strong> Imagine you are standing atop a mountain peak and wish to descend. You are blind so you cannot see the best way down and instead
									have to feel around you to determine which way descends the fastest, (in other words, which direction has the steepest slope). Once you identify the direction of steepest descent, you
									take one step in that direction. You repeat this process of feeling around, identifying the correct direction to move in, and taking a step in that direction. You repeat this process
									until you reach a point at which you can no longer identify a descending slope, signifying you are at the lowest point and have successfully descended.    
								</blockquote>
								Mathematically, to find the direction of steepest descent, we take the partial derrivative of the loss function \(L\) with respect to weights \(W^{(i)}\)
								and biases \(B^{(i)}\) as follows: 
								$$(4)\;\;\;\; L = (y - Xw)(y - Xw)^{T} $$
								$$(5)\;\;\;\; L = y^{T}y - 2w^{T}X^{T}y + w^{T}X^{T}Xw $$
								$$(6)\;\;\;\; \frac{\partial L}{\partial w} = -2X^{T}y + 2X^{T}Xw $$
								<blockquote>(4) is rewritten for convenience. (5) is the result of binomial expansion with matrix notation. (6) is the result of taking the partial derivative of (5).</blockquote>
								Equation (6) calculates the direction of steepest descent. So now we need to 'take a step' in that direction. We use the <u><i>learning rate</i></u> \(\lambda\) to accomplish this. Recall
								that weights represent information, so in specifying a learning rate we specify how 'big of a step' we take in the direction of \(\frac{\partial L}{\partial w}\). Here's the math:
								$$ \Delta{F}(w) = \frac{\partial L}{\partial w} = [\frac{\partial L }{\partial W^{(1)}}, \frac{\partial L }{\partial W^{(2)}}, ..., \frac{\partial L }{\partial W^{(i)}}] $$
								$$ w_{(i+1)} = w_i - \lambda\Delta{F}(w_i) $$

								Where \(\Delta{F}(w_i)\) symbolizes the direction of steepest descent for step \(i\), and \(w_{(i+1)}\) symbolizes the upcoming step, where we take the current location \(w_i\) and descend toward
								\(\Delta{F}(w_i)\) at a rate of \(\lambda\). Note, for further detail, the partial derrivatives for each weight matrix is expressed as follows:

								$$\frac{\partial L }{\partial W^{(i)}} = a^{(i)^T}(-(y-\hat{y}) \odot f'(z^{(i+1)}) = a^{(i)^T} \delta_{i+1}$$

								Okay, that's the end of backward propagation! To summarize, we start with the loss function calculated at the very end of forward propagation, then work backwards \(W^{(i)}, W^{(i-1)},W^{(i-2)},...,W^{(1)}\) 
								finding the partial derivatives to optimize each layer's weights. The process of forward and backward propagation repeats until the weights and biases are optimized, resulting in the loss function being minimized,
								to finally halt the algorithm. Finally, once we have our optimal weights \(w = [W^{(1)}, W^{(2)},...,W^{(i)}] \) we push the data through our network one last time to predict the output \(\hat{y}\):
								$$ 	z^{(2)} = XW^{(2)}	$$
								$$	a^{(2)} = f(z^{(2)})	$$
								$$ 	z^{(3)} = a^{(2)}W^{(3)}	$$
								$$	a^{(3)} = f(z^{(3)})	$$
								$$ 	z^{(4)} = a^{(3)}W^{(4)}	$$
								$$	a^{(4)} = f(z^{(4)})	$$
								$$...$$
								$$  z^{(i)} = a^{(i-1)}W^{(i)} $$
								$$  \hat{y} = f(z^{(i)}) $$
							</p>
							<h2><hr><center>The Code</center><hr></h2>
							<h3>Forward Propagation</h3>
							<p>
							Recall, forward propagation is the process of information moving from the input layer to the output layer of an artificial neural network. 
							We set up this process by initializing weights \(W^{(i)}\) with randomly generated values. This enables us to further initialize the output
							matrix \(z^{(i)}\) and activated values \(a^{(i)}\). It is okay to initialize with random guesses because through repeated forward and 
							backward propagation, these values will be adjusted and optimized as the loss function is minimized. 
								<pre>
									<code style="background-color:#33475b;color:white">
######### Activation Function ######### 
sigmoid <- function(Z){
	1/(1 + exp(-Z))
}
										
######### Forward Feed - Initializing #########
W_1 <- matrix(runif(63), nrow = 21, ncol = 3)
Z_2 <- X %*% W_1
A_2 <- sigmoid(Z_2)
										
W_2 <- matrix(runif(9), nrow = 3, ncol = 3)
Z_3 <- A_2 %*% W_2
Y_hat <- sigmoid(Z_3)
									</code>
								</pre>
								<p>
									<h3>Backward Propagation</h3>
									Now that we have our matrices initialized, we can begin propagating forward and backward through the network, taking a step in the direction
									of steepest descent each time. Recall, the learning rate controls how far we 
									move in the direction of steepest descent, or how big our 'step' is. If we make the learning rate too big (like 0.9) then our model will likely
									trust the direction too much and 'overstep', leading the model off course; too small, and our model will require many propagation interations
									to be optimized, which would be computationally expensive. The convergence boolean controls the number of propagation iterrations our model executes.
									When weight values are optimized, the algorithm halts.
								<pre>
									<code style="background-color:#33475b;color:white">
######### Partial Derrivative of Activation Function  ######### 
sigmoidprime <- function(z){
	exp(-z)/((1 + exp(-z))^2)
}
								
######### Gradient Descent ######### 
learning_rate <- 0.01
W_1_old <- matrix(rep(0, 42), nrow = 21, ncol = 2)
converge <- FALSE
while(!converge){
  ## initialize weights, runs it through activation function, calculate y_hat
  Z_2 <- X %*% W_1
  A_2 <- sigmoid(Z_2)
  Z_3 <- A_2 %*% W_2
  Y_hat <- sigmoid(Z_3)

  ## find gradient
  delta_3 <- (-(Y - Y_hat) * sigmoidprime(Z_3))
  djdw2 <- t(A_2) %*% delta_3
  delta_2 <- delta_3 %*% t(W_2) * sigmoidprime(Z_2)
  djdw1 <- t(X) %*% delta_2

  ## update weights
  W_1 <- W_1 - learning_rate * djdw1
  W_2 <- W_2 - learning_rate * djdw2

  ## determine convergence
  w1round <- sum(round(W_1, 4))
  w1round_old <- sum(round(W_1_old, 4))
  if(w1round != w1round_old){
    W_1_old = W_1
  }else{
    converge = TRUE
  }
}</code>
								</pre>	
								<p>
									That's it! Using the coded algorithm above, we found the optimal weights. Testing the accuracy of our predictions using cross-validation, this model is about
									84% accurate overall in its predictions.
								</p>
								<h2><hr><center>Diabetes Status Calculator</center><hr></h2>
							<p>
								Below, I created a form for you to input data and run it through our algorithm to calculate diabetes risk. Play around with values to
								explore which variables have the highest inluence on type 2 diabetes development!
							</p>
							
							<form>
								
								<p>1. What is your sex?</p>
								<input type="radio" id="male" name="sex"> <label for="male">Male</label>
								<input type="radio" name="sex" id="fem"> <label for="fem">Female</label>
								
					
								<p>2. Do you have difficulty walking or climbing stairs?</p>
								<input type="radio" name="walk" value="" id="walkY"><label for="walkY"> Yes</label>
								<input type="radio" name="walk" id="z"> <label for="z">No</label>
					
								<p>3. Do you have healthcare coverage, including health insurance, prepaid plans such as HMO, etc.?</p>
								<input type="radio" name="cov" value="" id="covY"><label for="covY">Yes</label>
								<input type="radio" name="cov" id="a"> <label for="a">No</label>
					
								<p>4. Is there a time in the past 12 months when you needed	to see a doctor but could not because of cost?</p>
								<input type="radio" name="cost" value="" id="costY"> <label for="costY"> Yes</label>
								<input type="radio" name="cost" id="b"> <label for="b">No</label>
					
								<p>5. Do you have hypertension (high blood pressure)?		 </p>
								<input type="radio" name="hyp" value="" id="hypY"> <label for="hypY">Yes</label>
								<input type="radio" name="hyp" id="c"> <label for="c">No</label>
					
								<p>6. Do you have high cholesterol?		 </p>
								<input type="radio" name="Hchol" value="" id="HcholY"> <label for="HcholY">Yes</label>
								<input type="radio" name="Hchol"id="d"> <label for="d">No</label>
					
								<p>7. Have you had your cholesterol checked in the last 5 years?		 </p>
								<input type="radio" name="Cchol" value="" id="CcholY"> <label for="CcholY">Yes</label>
								<input type="radio" name="Cchol"id="e"> <label for="e">No</label>
					
								<p>8. Have you smoked as least 100 cigarettes in your life? [Note: 5 packs = 100 cigarettes]		 </p>
								<input type="radio" name="smoke" value="" id="smokeY"> <label for="smokeY">Yes</label>
								<input type="radio" name="smoke"id="f"> <label for="f">No</label>
					
								<p>9. Have you ever had a stroke?		 </p>
								<input type="radio" name="stroke" value="" id="strokeY"> <label for="strokeY">Yes</label>
								<input type="radio" name="stroke"id="g"> <label for="g">No</label>
					
								<p>10. Have you had coronary heart disease (CHD) or myocardial infraction (MI)?		 </p>
								<input type="radio" name="heart" value="" id="heartY"> <label for="heartY">Yes</label>
								<input type="radio" name="heart"id="h"> <label for="h">No</label>
					
								<p>11. Have you been physically active in the past 30 days?	 </p>
								<input type="radio" name="physAt" value="" id="physAtY"> <label for="physAtY">Yes</label>
								<input type="radio" name="physAt"id="i"> <label for="i">No</label>
					
								<p>12. Do you consume at least 1 fruit a day?		 </p>
								<input type="radio" name="fru" value="" id="fruY"> <label for="fruY">Yes</label>
								<input type="radio" name="fru"id="k"> <label for="k">No</label>
					
								<p>13. Do you consume at least 1 vegetable a day?		 </p>
								<input type="radio" name="veg" value="" id="vegY"> <label for="vegY">Yes</label>
								<input type="radio" name="veg"id="l"> <label for="l">No</label>
					
								<p>14. Do you consume heavy amounts of alcohol? For men this means having more than 14 drinks per week. For women, this means having more than 7 drinks per week.</p>
								<input type="radio" name="alc" value="" id="alcY"> <label for="alcY">Yes</label>
								<input type="radio" name="alc"id="q"><label for="q">No</label>
						
								<div class="slidecontainer">
									<p>15. What is your BMI?</p>
									<input type="range" min="12" max="98" value="12" class="slider" id="bmi">
									<center><p>Value: <span id="bmiV"></span></p></center>
					
									<p>16. What is your Income?
										<ul>
											<li>1 = less than $10,000</li>
											<li>2 = between $10,000 and $15,000</li>
											<li>3 = between $15,000 and $20,000</li>
											<li>4 = between $20,000 and $25,000</li>
											<li>5 = between $25,000 and $35,000</li>
											<li>6 = between $35,000 and $50,000</li>
											<li>7 = between $50,000 and $75,000</li>
											<li>8 = more than $75,000</li>
										</ul>
									</p>
									<input type="range" min="1" max="8" value="1" class="slider" id="income">
									<center><p>Value: <span id="incomeV"></span></p></center>
					
									 <p>17. What is your highest level of Education?
										<ul>
											<li>1 = None</li>
											<li>2 = Elementary</li>
											<li>3 = Some High School</li>
											<li>4 = High School Graduate</li>
											<li>5 = Some College or Technical School</li>
											<li>6 = College Graduate</li>
										</ul>
									 </p>
									<input type="range" min="1" max="6" value="1" class="slider" id="edu">
									<center><p>Value: <span id="eduV"></span></p></center>
					
									<p>18. How many days in the past month have you experienced physical illness and/or injury?</p>
									<input type="range" min="0" max="30" value="0" class="slider" id="phys_ill">
									<center><p>Value: <span id="phys_illV"></span></p></center>
					
									 <p>19. What is your personal ranking of your General Health?
										<ul>
											<li>1 = Excellent</li>
											<li>2 = Very Good</li>
											<li>3 = Good</li>
											<li>4 = Fair</li>
											<li>5 = Poor</li>
										</ul>
									 </p>
									<input type="range" min="1" max="5" value="1" class="slider" id="gen_health">
									<center><p>Value: <span id="gen_healthV"></span></p></center>
					
									<p>20. How many days in the past month have you experienced feelings of stress, depression, and problems with emotions? </p>
									<input type="range" min="0" max="30" value="0" class="slider" id="men_health">
									<center><p>Value: <span id="men_healthV"></span></p></center>

									<p>21. What is your age? </p>
									<input type="range" min="0" max="100" value="0" class="slider" id="age">
									<center><p>Value: <span id="ageV"></span></p></center>
								</div>
								
								<button type="button" onclick="getSelectedValue()">Submit</button>


							</form>
					
							
							<center><div id="output"></div></center>
					
							<script>
								var bmi = document.getElementById("bmi");
								var output = document.getElementById("bmiV");
								output.innerHTML = bmi.value;
													
								bmi.oninput = function() {
									output.innerHTML = this.value;
								}
					
								var income = document.getElementById("income");
								var output1 = document.getElementById("incomeV");
								output1.innerHTML = income.value;
													
								income.oninput = function() {
									 output1.innerHTML = this.value;
								}
					
								var edu = document.getElementById("edu");
								var output2 = document.getElementById("eduV");
								output2.innerHTML = edu.value;
													
								edu.oninput = function() {
								  output2.innerHTML = this.value;
								}
					
								var phys_ill = document.getElementById("phys_ill");
								var output3 = document.getElementById("phys_illV");
								output3.innerHTML = phys_ill.value;
													
								phys_ill.oninput = function() {
								  output3.innerHTML = this.value;
								}
					
								var genh = document.getElementById("gen_health");
								var output4 = document.getElementById("gen_healthV");
								output4.innerHTML = genh.value;
													
								genh.oninput = function() {
								  output4.innerHTML = this.value;
								}
					
								var menh = document.getElementById("men_health");
								var output5 = document.getElementById("men_healthV");
								output5.innerHTML = menh.value;
													
								menh.oninput = function() {
								  output5.innerHTML = this.value;
								}

								var age = document.getElementById("age");
								var output6 = document.getElementById("ageV");
								output6.innerHTML = age.value;
													
								age.oninput = function() {
								  output6.innerHTML = this.value;
								}






								function getSelectedValue() {
								// Given elements
								var elements = [
								3.721384 ,-1.5093279,
								-8.676933, -0.8859655,
								-2.797055, -1.2006840,
								29.809626,  3.7154532,
								15.426957,  1.8562890,
								5.275746 ,-0.6546053,
								-10.234618, -2.7325197,
								-8.545799 , 0.8761673,
								-7.564835 ,-0.7113932,
								33.266242 , 6.1760378,
								-4.849617 , 7.2509424,
								11.534136 , 5.2590120,
								-11.287855, -2.9107076,
								-22.777411, -4.1231071,
								1.216481  ,1.1619911,
								-3.483598 , 1.1331227,
								1.499961 ,-0.8913315,
								-15.758150, -1.7384091,
								-9.283742 ,-2.9990731,
								-15.009721, -2.6769167,
								12.364432 , 1.2307232
								];

								// Create a matrix with 21 rows and 2 columns
								var rows = 21;
								var cols = 2;

								// Initialize the matrix
								var W_3 = [];

								// Populate the matrix with elements
								for (let i = 0; i < rows; i++) {
									W_3[i] = elements.slice(i * cols, (i + 1) * cols);
								}

								// Given elements
								var elements = [
								-12.97498,  12.97498,
								14.77484 ,-14.77484
								];

								// Create a matrix with 2 rows and 2 columns
								var rows = 2;
								var cols = 2;

								// Initialize the matrix
								var W_4 = [];

								// Populate the matrix with elements
								for (let i = 0; i < rows; i++) {
									W_4[i] = elements.slice(i * cols, (i + 1) * cols);
								}

								

								// Function to perform dot product of two matrices
								function dotProduct(matrix1, matrix2) {
								var result = [];

								for (let i = 0; i < matrix1.length; i++) {
									result[i] = [];
									for (let j = 0; j < matrix2[0].length; j++) {
									let sum = 0;
									for (let k = 0; k < matrix1[0].length; k++) {
										sum += matrix1[i][k] * matrix2[k][j];
									}
									result[i][j] = sum;
									}
								}

								return result;
								}
									// Sigmoid function in JavaScript		
									function sigmoid(Z) {
										return 1 / (1 + Math.exp(-Z));	
									}
									
									var hyp = document.getElementById('hypY');
									var chol = document.getElementById('HcholY');
									var Cchol = document.getElementById('CcholY');
									var bmi1 = Number(bmi.value);
									var smoke = document.getElementById('smokeY');
									var stroke = document.getElementById('strokeY');
									var heart = document.getElementById('heartY');
									var phys = document.getElementById('physAtY');
									var fru = document.getElementById('fruY');
									var veg = document.getElementById('vegY');
									var alc = document.getElementById('alcY');
									var cov = document.getElementById('covY');
									var cost = document.getElementById('costY');
									var genh1 = Number(genh.value);
									var menh1 = Number(menh.value);
									var phys_ill1 = Number(phys_ill.value);
									var walk = document.getElementById('walkY');
									var male = document.getElementById('male');
									var age1 = Number(age.value);
									var edu1 = Number(edu.value);
									var income1 = Number(income.value);
									
									
									var male1 = 0;
									var hyp1 = 0;
									var walk1    = 0;
									var coverage1  = 0;
									var cost1    = 0;
									var chol1    = 1;
									var chol_check1    = 0;
									var smoker1    = 0;
									var heart1    = 0;
									var stroke1    = 0;
									var phys1    = 0;
									var fruit1    = 0;
									var veg1    = 0;
									var alc1    = 0;
									
									
									if (male.checked) { male1 = 1} 
									if (hyp.checked) { hyp1 = 1} 
									if (bmi1 <= 27) { bmi1 = 0} 
									if (genh1 <= 3) { genh1 = 0} 
									if (phys_ill1 <= 15) { phys_ill1 = 0} 
									if (chol.checked) { chol1 = 0} 
									if (Cchol.checked) { chol_check1 = 1} 
									if (age1 <= 44) { age1 = 0} 
									if (heart.checked) { heart1 = 1} 
									if (stroke.checked) { stroke1 = 1} 
									if (income1 <= 4) { income1 = 0} 
									if (fru.checked) { fruit1 = 1} 
									if (veg.checked) { veg1 = 1} 
									if (alc.checked) { alc1 = 1} 
									if (smoke.checked) { smoker1 = 1} 
									if (phys.checked) { phys1 = 1} 
									if (cov.checked) { coverage1 = 1} 
									if (cost.checked) { cost1 = 1} 
									if (walk.checked) { walk1 = 1} 
									if (edu1 <= 3) { edu1 = 0} 
									if (menh1 <= 15) { menh1 = 0} 
									
									
									var user_input = [[hyp1, chol1, chol_check1, bmi1, smoker1, stroke1, heart1, phys1, fruit1, veg1, alc1, coverage1, cost1, genh1, menh1, phys_ill1, walk1, male1, age1, edu1, income1]];
									//var user_input = [[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]];
									// Final Output Propagation
									
									var Z_4 = dotProduct(user_input, W_3);
									var A_4 = Z_4.map(row => row.map(element => sigmoid(element)));
									var Z_5 = dotProduct(A_4, W_4);
									var Y_hat = Z_5.map(row => row.map(element => sigmoid(element)));


									var outputDiv = document.getElementById('output');
									
									var string = "idk man";
									var conf = 0.00;
									if(Y_hat[0][0] >= 0.5){
										string = "low";
										conf = 100*Y_hat[0][0];
									} else if(Y_hat[0][0] < 0.5){
										string = "high";
										conf = 100*Y_hat[0][1];
									}
									
									outputDiv.innerHTML = "You are at " + "<b>" + string + "</b>" + " risk of developing type 2 diabetes! By the way, we are about " + conf.toFixed(2) + "% confident in this prediction.";
									
									
									//outputDiv.innerHTML = 500;
								}

							</script>

							<p>
								<br><blockquote>
									<strong>Disclaimer. </strong>This calculator should not be trusted blindly so please consult a medical professional for credible and trustworthy claims.
									Also, I will not collect, track, nor save any data entered in this form. 
								</blockquote>
							</p>
							





							<h2><hr><center>Abstract</center><hr></h2>
							<p>
								<ol>
									<dl> [1] <a href="https://www.niddk.nih.gov/health-information/health-statistics/diabetes-statistics" target="_blank"> NIH Diabetes Facts and Statistics</a> </dl>
									<dl> [2] <a href="https://www.cdc.gov/diabetes/managing/problems.html#:~:text=Even%20though%20diabetes%20can%20lead,%2C%20hearing%2C%20and%20mental%20health" target="_blank"> CDC Diabetes Information</a> </dl>
									<dl> [3] <a href="https://pubmed.ncbi.nlm.nih.gov/9215725/" target="_blank"> Neocortical neuron number in humans: effect of sex and age</a> </dl> </dl>
									<dl> 
										[4] Prerequisite Mathematical Knowledge guide
											<ol> 1. <a href="https://www.khanacademy.org/math/multivariable-calculus/multivariable-derivatives/partial-derivatives/v/partial-derivatives-introduction" target="_blank"> Calculus - Partial Derivatives</a></ol>
											<ol> 2. <a href="https://www.khanacademy.org/math/linear-algebra" target="_blank"> Linear Algebra - Operations</a> </ol>		
									</dl>
									<dl>
										[5] The values in the W_1 matrix. This can be used to interpret magnitude of influence each predictor has on diabetes risk. <br><br>
										<center><img src="Diabetes NN/w1.png" heigh=300 width=300 alt="" /></center>
									</dl>

								</ol>
							</p>	
						</div>
					</div>


				<!-- Footer -->
				<footer id="footer">
					<div class="inner">
						<section>
							<h2>Contact Me</h2>
							<p><strong>Email: </strong>smulherin519@gmail.com<br><strong>Location: </strong>Los Angeles, CA</p>
						</section>
						<section>
							<h2>Follow</h2>
							<ul class="icons">
								<li><a href="https://www.linkedin.com/in/sean-mulherin-93640913a/" class="icon brands style2 fa-linkedin" target="_blank"><span class="label">Linkedin</span></a></li>
								<li><a href="https://github.com/SeanMulherin" class="icon brands style2 fa-github" target="_blank"><span class="label">GitHub</span></a></li>
							</ul>
						</section>
						<ul class="copyright">
							<li>&copy; Sean Mulherin. All rights reserved</li>
						</ul>
					</div>
				</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
